<th:block th:fragment="addWatchListModal">
    <!-- Modal Add -->
    <div class="modal fade" id="addWatchListModal" tabindex="-1" aria-labelledby="addWatchListModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content" style="background-color: #fcfbf4; border: 2px solid #000;">
                
                <!-- Modal Header -->
                <div class="modal-header" style="border-bottom: 2px solid #ddd;">
                    <h5 class="modal-title fw-bold" id="addWatchListModalLabel" style="color: #1a1a1a;">Add New WatchList</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>

                <!-- Modal Body -->
                <!-- PENTING: enctype="multipart/form-data" wajib ada untuk upload file -->
                <form th:action="@{/watchlists/save}" method="post" enctype="multipart/form-data" th:object="${watchListForm}">
                    <div class="modal-body">
                        
                        <div class="row">
                            <!-- Kolom Kiri: Upload Poster -->
                            <div class="col-md-4 mb-3 d-flex flex-column align-items-center">
                                <label class="form-label fw-bold w-100">Poster Image</label>
                                
                                <!-- Area Preview Gambar -->
                                <div class="mb-2" style="width: 100%; height: 250px; border: 2px dashed #c4a45e; border-radius: 8px; overflow: hidden; display: flex; align-items: center; justify-content: center; background-color: #f0eee4;">
                                    <!-- Gambar Preview (Hidden default) -->
                                    <img id="imgPreviewAdd" src="#" alt="Preview" style="display: none; width: 100%; height: 100%; object-fit: cover;">
                                    
                                    <!-- Placeholder Text/Icon (Show default) -->
                                    <div id="placeholderAdd" class="text-center text-muted">
                                        <i class="bi bi-image fs-1"></i>
                                        <div style="font-size: 12px;">No Image Selected</div>
                                    </div>
                                </div>

                                <!-- Input File -->
                                <input class="form-control form-control-sm" type="file" id="coverImage" name="coverImage" accept="image/*" onchange="previewImageAdd(this)">
                                <div class="form-text text-muted" style="font-size: 11px;">Format: JPG, PNG, JPEG</div>
                            </div>

                            <!-- Kolom Kanan: Input Data Film -->
                            <div class="col-md-8">
                                
                                <!-- Title -->
                                <div class="mb-3">
                                    <label for="title" class="form-label fw-bold">Title <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="title" name="title" placeholder="e.g., Inception, Breaking Bad" required>
                                </div>

                                <div class="row">
                                    <!-- Type -->
                                    <div class="col-md-6 mb-3">
                                        <label for="type" class="form-label fw-bold">Type <span class="text-danger">*</span></label>
                                        <select class="form-select" id="type" name="type" required>
                                            <option value="" disabled selected>Select Type</option>
                                            <option value="Movie">Movie</option>
                                            <option value="Series">Series</option>
                                        </select>
                                    </div>

                                    <!-- Status (UPDATED: 3 Options) -->
                                    <div class="col-md-6 mb-3">
                                        <!-- Perhatikan name="status", pastikan Entity Java Anda punya field 'status' bertipe String/Enum -->
                                        <label for="status" class="form-label fw-bold">Status <span class="text-danger">*</span></label>
                                        <select class="form-select" id="status" name="status" required>
                                            <option value="" disabled selected>Select Status</option>
                                            <option value="Plan to Watch">Plan to Watch</option>
                                            <option value="Watching">Watching</option>
                                            <option value="Watched">Watched</option>
                                        </select>
                                    </div>
                                </div>

                                <div class="row">
                                    <!-- Genre -->
                                    <div class="col-md-6 mb-3">
                                        <label for="genre" class="form-label fw-bold">Genre <span class="text-danger">*</span></label>
                                        <input type="text" class="form-control" id="genre" name="genre" placeholder="e.g., Sci-Fi, Drama" required>
                                    </div>

                                    <!-- Release Year -->
                                    <div class="col-md-6 mb-3">
                                        <label for="releaseYear" class="form-label fw-bold">Release Year <span class="text-danger">*</span></label>
                                        <input type="number" class="form-control" id="releaseYear" name="releaseYear" placeholder="e.g., 2024" required>
                                    </div>
                                </div>

                                <!-- Rating -->
                                <div class="mb-3">
                                    <label for="rating" class="form-label fw-bold">Rating (1-10) <span class="text-danger">*</span></label>
                                    <input type="number" class="form-control" id="rating" name="rating" min="1" max="10" step="0.1" placeholder="Enter rating (1-10)" required>
                                </div>

                                <!-- Notes -->
                                <div class="mb-3">
                                    <label for="notes" class="form-label fw-bold">Notes / Review</label>
                                    <textarea class="form-control" id="notes" name="notes" rows="3" placeholder="Write your thoughts about this movie..."></textarea>
                                </div>

                            </div>
                        </div>
                    </div>

                    <!-- Modal Footer -->
                    <div class="modal-footer" style="border-top: 2px solid #ddd;">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn" style="background-color: #0d6efd; color: white;">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Script Javascript untuk Preview Gambar -->
    <script>
        function previewImageAdd(input) {
            const preview = document.getElementById('imgPreviewAdd');
            const placeholder = document.getElementById('placeholderAdd');
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    placeholder.style.display = 'none';
                }
                
                reader.readAsDataURL(input.files[0]);
            } else {
                preview.src = '#';
                preview.style.display = 'none';
                placeholder.style.display = 'block';
            }
        }
    </script>
</th:block>